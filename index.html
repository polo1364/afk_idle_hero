<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ›æ©Ÿå§!å‹‡è€… - No-brainer Heroes</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: oklch(0.12 0.02 220);
            color: oklch(0.92 0.01 180);
            min-height: 100vh;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid oklch(0.3 0.02 220);
            background: oklch(0.18 0.02 220);
            color: oklch(0.92 0.01 180);
            cursor: pointer;
            font-size: 1rem;
            border-radius: 0.25rem;
            transition: all 0.2s;
            font-weight: 500;
        }
        
        .btn:hover {
            border-color: oklch(0.65 0.15 200);
            color: oklch(0.65 0.15 200);
            background: oklch(0.25 0.02 220);
        }
        
        .btn-primary {
            background: oklch(0.65 0.15 200);
            border-color: oklch(0.65 0.15 200);
            color: oklch(0.12 0.02 220);
        }
        
        .btn-primary:hover {
            background: oklch(0.7 0.15 200);
            border-color: oklch(0.7 0.15 200);
        }
        
        .card {
            background: oklch(0.18 0.02 220);
            border: 2px solid oklch(0.3 0.02 220);
            border-radius: 0.5rem;
            padding: 1.5rem;
        }
        
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .grid {
            display: grid;
            gap: 1.5rem;
        }
        
        .grid-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        
        .flex {
            display: flex;
        }
        
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }
        
        .text-center { text-align: center; }
        .text-primary { color: oklch(0.65 0.15 200); }
        .text-muted { color: oklch(0.6 0.01 180); }
        
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-8 { margin-top: 2rem; }
        
        .w-full { width: 100%; }
        .h-screen { min-height: 100vh; }
        
        .progress-bar {
            height: 0.5rem;
            background: oklch(0.22 0.02 220);
            border-radius: 0.25rem;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: oklch(0.65 0.15 200);
            transition: width 0.3s;
        }
        
        .hero-portrait {
            font-size: 3rem;
            text-align: center;
        }
        
        .stat-box {
            background: oklch(0.22 0.02 220);
            border: 1px solid oklch(0.3 0.02 220);
            padding: 0.75rem;
            border-radius: 0.5rem;
        }
        
        .position-slot {
            height: 8rem;
            border: 2px dashed oklch(0.3 0.02 220);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .position-slot:hover {
            border-color: oklch(0.65 0.15 200);
        }
        
        .position-slot.filled {
            border-style: solid;
            background: oklch(0.22 0.02 220);
        }
        
        .position-label {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            width: 1.5rem;
            height: 1.5rem;
            background: oklch(0.22 0.02 220);
            border: 1px solid oklch(0.3 0.02 220);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .top-bar {
            background: oklch(0.18 0.02 220);
            border-bottom: 2px solid oklch(0.3 0.02 220);
            padding: 1rem;
        }
        
        @media (max-width: 768px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;
        
        // Game Context
        const GameContext = createContext();
        
        const useGame = () => useContext(GameContext);
        
        function GameProvider({ children }) {
            const [currentScene, setCurrentScene] = useState('menu');
            const [saveData, setSaveData] = useState(null);
            
            useEffect(() => {
                const saved = localStorage.getItem('gameState');
                if (saved) {
                    try {
                        const data = JSON.parse(saved);
                        setSaveData(data);
                    } catch (e) {}
                }
            }, []);
            
            const newGame = (difficulty) => {
                const initialHero = {
                    id: 'hero-1',
                    name: 'çå¦®ä½›',
                    class: 'mage',
                    portrait: 'ğŸ§™â€â™€ï¸',
                    level: 1,
                    exp: 0,
                    maxExp: 100,
                    hp: 30,
                    maxHp: 30,
                    mp: 16,
                    maxMp: 16,
                    attack: 0,
                    defense: 1,
                    magic: 14,
                    magicDefense: 3,
                    strength: 3,
                    intelligence: 9,
                    agility: 5,
                    vitality: 9,
                    skills: [
                        { id: 'skill-1', name: 'é­”å½ˆè¡“', type: 'normal', level: 1 },
                        { id: 'skill-2', name: 'å…‰ä¹‹æŸç¸›', type: 'skill', level: 1 }
                    ]
                };
                
                const newSave = {
                    day: 0,
                    location: 'æ›™å…‰ä¹‹åœ°',
                    difficulty,
                    gold: 10200,
                    heroes: [initialHero],
                    formation: [initialHero, null, null, null, null, null]
                };
                
                setSaveData(newSave);
                localStorage.setItem('gameState', JSON.stringify(newSave));
                setCurrentScene('town');
            };
            
            const updateFormation = (newFormation) => {
                const updated = { ...saveData, formation: newFormation };
                setSaveData(updated);
                localStorage.setItem('gameState', JSON.stringify(updated));
            };
            
            return (
                <GameContext.Provider value={{ 
                    currentScene, 
                    setCurrentScene, 
                    saveData, 
                    newGame,
                    updateFormation
                }}>
                    {children}
                </GameContext.Provider>
            );
        }
        
        // Main Menu Component
        function MainMenu() {
            const { setCurrentScene } = useGame();
            
            return (
                <div className="h-screen flex flex-col items-center justify-center">
                    <div style={{ textAlign: 'center', marginBottom: '3rem' }}>
                        <h1 style={{ fontSize: '3.5rem', fontWeight: 'bold', marginBottom: '1rem' }} className="text-primary">
                            æ›æ©Ÿå§!å‹‡è€…
                        </h1>
                        <h2 style={{ fontSize: '2rem', fontFamily: 'monospace', letterSpacing: '0.1em' }}>
                            No-brainer Heroes
                        </h2>
                    </div>
                    
                    <div className="flex flex-col gap-4" style={{ width: '100%', maxWidth: '28rem' }}>
                        <button className="btn w-full" style={{ padding: '1.5rem' }} onClick={() => alert('åŠŸèƒ½é–‹ç™¼ä¸­')}>
                            ç„¡ç›¡æ¨¡å¼
                        </button>
                        <button className="btn w-full" style={{ padding: '1.5rem' }} onClick={() => setCurrentScene('setup')}>
                            æ•…äº‹æ¨¡å¼
                        </button>
                        <button className="btn w-full" style={{ padding: '1.5rem' }} onClick={() => alert('åŠŸèƒ½é–‹ç™¼ä¸­')}>
                            æˆå°±
                        </button>
                        <button className="btn w-full" style={{ padding: '1.5rem' }} onClick={() => alert('åŠŸèƒ½é–‹ç™¼ä¸­')}>
                            è¨­å®š
                        </button>
                        <button className="btn w-full" style={{ padding: '1.5rem' }} onClick={() => alert('åŠŸèƒ½é–‹ç™¼ä¸­')}>
                            è£½ä½œäººå“¡
                        </button>
                        <button className="btn w-full" style={{ padding: '1.5rem' }} onClick={() => window.close()}>
                            é€€å‡º
                        </button>
                    </div>
                    
                    <div style={{ position: 'fixed', bottom: '1rem', right: '1rem' }} className="text-muted">
                        v1.0.0
                    </div>
                </div>
            );
        }
        
        // Game Setup Component
        function GameSetup() {
            const { setCurrentScene, newGame } = useGame();
            const [difficulty, setDifficulty] = useState('normal');
            
            return (
                <div className="container">
                    <div className="mb-8">
                        <h1 style={{ fontSize: '2.5rem', fontWeight: 'bold' }} className="text-primary mb-2">éŠæˆ²è¨­å®š</h1>
                        <p className="text-muted">é¸æ“‡ä½ çš„å†’éšªé…ç½®</p>
                    </div>
                    
                    <div className="grid grid-3 mb-8">
                        <div className="card">
                            <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold' }} className="mb-4">é›£åº¦é¸æ“‡</h2>
                            <div className="flex flex-col gap-2">
                                <button 
                                    className={difficulty === 'normal' ? 'btn btn-primary w-full' : 'btn w-full'}
                                    onClick={() => setDifficulty('normal')}
                                >
                                    æ™®é€š
                                </button>
                                <button 
                                    className={difficulty === 'hard' ? 'btn btn-primary w-full' : 'btn w-full'}
                                    onClick={() => setDifficulty('hard')}
                                >
                                    å›°é›£
                                </button>
                                <button 
                                    className={difficulty === 'nightmare' ? 'btn btn-primary w-full' : 'btn w-full'}
                                    onClick={() => setDifficulty('nightmare')}
                                >
                                    æƒ¡å¤¢
                                </button>
                            </div>
                        </div>
                        
                        <div className="card">
                            <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold' }} className="mb-4">åœ°åœ–é¸æ“‡</h2>
                            <div className="grid grid-2 gap-2">
                                <div className="stat-box text-center">æ›™å…‰ä¹‹åœ°</div>
                                <div className="stat-box text-center" style={{ opacity: 0.5 }}>ğŸ”’ æ°¸åŠ«ä¹‹åœ°</div>
                                <div className="stat-box text-center" style={{ opacity: 0.5 }}>ğŸ”’ éºå¿˜ä¹‹åœ°</div>
                                <div className="stat-box text-center" style={{ opacity: 0.5 }}>ğŸ”’ å‹¤äº‚ä¹‹åœ°</div>
                            </div>
                        </div>
                        
                        <div className="card">
                            <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold' }} className="mb-4">åˆå§‹è‹±é›„</h2>
                            <div className="grid grid-2 gap-2">
                                {['ğŸ›¡ï¸ å®ˆè­·', 'âš”ï¸ æˆ°å£«', 'ğŸ—¡ï¸ åˆºå®¢', 'ğŸ‘Š æ ¼é¬¥', 'ğŸ¹ å°„æ‰‹', 'ğŸ”® æ³•å¸«', 'âœ¨ ç‰§å¸«'].map(hero => (
                                    <button key={hero} className="btn" style={{ padding: '1rem' }}>
                                        {hero}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                    
                    <div className="flex justify-center gap-4">
                        <button className="btn" onClick={() => setCurrentScene('menu')}>è¿”å›</button>
                        <button className="btn btn-primary" onClick={() => newGame(difficulty)}>
                            é–‹å•Ÿä¸€æ®µå†’éšª
                        </button>
                    </div>
                </div>
            );
        }
        
        // Town Component
        function Town() {
            const { setCurrentScene, saveData } = useGame();
            
            if (!saveData) return null;
            
            const buildings = [
                { name: 'å†’éšª', icon: 'ğŸ—ºï¸', action: () => setCurrentScene('map') },
                { name: 'è‹±é›„', icon: 'ğŸ‘¥', action: () => setCurrentScene('heroes') },
                { name: 'ç·¨çµ„', icon: 'âš”ï¸', action: () => setCurrentScene('formation') },
                { name: 'å•†åº—', icon: 'ğŸª', action: () => alert('åŠŸèƒ½é–‹ç™¼ä¸­') },
                { name: 'æˆå°±', icon: 'ğŸ†', action: () => alert('åŠŸèƒ½é–‹ç™¼ä¸­') },
                { name: 'è¨­å®š', icon: 'âš™ï¸', action: () => alert('åŠŸèƒ½é–‹ç™¼ä¸­') }
            ];
            
            return (
                <div>
                    <div className="top-bar">
                        <div className="container flex justify-between items-center">
                            <div className="flex items-center gap-6">
                                <div>ç¬¬ <span className="text-primary" style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>{saveData.day}</span> å¤©</div>
                                <div>{saveData.location}</div>
                            </div>
                            <div className="flex items-center gap-2">
                                <span style={{ fontSize: '1.5rem' }}>ğŸ’°</span>
                                <span style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{saveData.gold.toLocaleString()}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div className="container">
                        <div className="mb-8">
                            <h1 style={{ fontSize: '2.5rem', fontWeight: 'bold' }} className="text-primary mb-2">åŸé®</h1>
                            <p className="text-muted">é¸æ“‡ä½ è¦å‰å¾€çš„åœ°æ–¹</p>
                        </div>
                        
                        <div className="grid grid-3 mb-8">
                            {buildings.map(building => (
                                <div key={building.name} className="card text-center" style={{ cursor: 'pointer' }} onClick={building.action}>
                                    <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>{building.icon}</div>
                                    <h3 style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>{building.name}</h3>
                                </div>
                            ))}
                        </div>
                        
                        <div className="flex justify-center">
                            <button className="btn" onClick={() => setCurrentScene('menu')}>è¿”å›ä¸»é¸å–®</button>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Heroes Component
        function Heroes() {
            const { setCurrentScene, saveData } = useGame();
            const [selectedHero, setSelectedHero] = useState(0);
            
            if (!saveData) return null;
            
            const hero = saveData.heroes[selectedHero];
            
            return (
                <div>
                    <div className="top-bar">
                        <div className="container flex items-center gap-4">
                            <button className="btn" onClick={() => setCurrentScene('town')}>â† è¿”å›</button>
                            <h1 style={{ fontSize: '1.5rem', fontWeight: 'bold' }} className="text-primary">è‹±é›„</h1>
                        </div>
                    </div>
                    
                    <div className="container">
                        <div className="grid grid-3 gap-6">
                            <div className="card">
                                <h2 style={{ fontSize: '1.25rem', fontWeight: 'bold' }} className="mb-4">è‹±é›„åˆ—è¡¨</h2>
                                <div className="flex flex-col gap-2">
                                    {saveData.heroes.map((h, idx) => (
                                        <button 
                                            key={h.id}
                                            className={selectedHero === idx ? 'btn btn-primary w-full' : 'btn w-full'}
                                            onClick={() => setSelectedHero(idx)}
                                        >
                                            <span style={{ fontSize: '1.5rem' }}>{h.portrait}</span> {h.name} Lv.{h.level}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            
                            <div className="card" style={{ gridColumn: 'span 2' }}>
                                <div className="flex items-start gap-6 mb-6">
                                    <div className="hero-portrait">{hero.portrait}</div>
                                    <div style={{ flex: 1 }}>
                                        <h2 style={{ fontSize: '2rem', fontWeight: 'bold' }} className="mb-2">{hero.name}</h2>
                                        <div className="text-muted mb-2">è·æ¥­: {hero.class} Â· ç­‰ç´š: {hero.level}</div>
                                        <div>
                                            <div className="progress-bar">
                                                <div className="progress-fill" style={{ width: `${(hero.exp / hero.maxExp) * 100}%` }}></div>
                                            </div>
                                            <div className="text-muted" style={{ fontSize: '0.875rem', marginTop: '0.25rem' }}>
                                                ç¶“é©—: {hero.exp}/{hero.maxExp}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="grid grid-3 gap-4 mb-6">
                                    <div className="stat-box">
                                        <div className="text-muted" style={{ fontSize: '0.75rem' }}>ç”Ÿå‘½</div>
                                        <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{hero.hp}/{hero.maxHp}</div>
                                    </div>
                                    <div className="stat-box">
                                        <div className="text-muted" style={{ fontSize: '0.75rem' }}>è¡Œå‹•</div>
                                        <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{hero.mp}/{hero.maxMp}</div>
                                    </div>
                                    <div className="stat-box">
                                        <div className="text-muted" style={{ fontSize: '0.75rem' }}>æ”»æ“Š</div>
                                        <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{hero.attack}</div>
                                    </div>
                                    <div className="stat-box">
                                        <div className="text-muted" style={{ fontSize: '0.75rem' }}>é˜²ç¦¦</div>
                                        <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{hero.defense}</div>
                                    </div>
                                    <div className="stat-box">
                                        <div className="text-muted" style={{ fontSize: '0.75rem' }}>é­”æ³•</div>
                                        <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{hero.magic}</div>
                                    </div>
                                    <div className="stat-box">
                                        <div className="text-muted" style={{ fontSize: '0.75rem' }}>é­”æŠ—</div>
                                        <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{hero.magicDefense}</div>
                                    </div>
                                </div>
                                
                                <div>
                                    <h3 style={{ fontSize: '1.25rem', fontWeight: 'bold' }} className="mb-4">è‹±é›„æŠ€èƒ½</h3>
                                    <div className="flex flex-col gap-4">
                                        {hero.skills.map(skill => (
                                            <div key={skill.id} className="stat-box">
                                                <div className="flex justify-between items-center mb-2">
                                                    <div>
                                                        <span style={{ 
                                                            padding: '0.25rem 0.5rem', 
                                                            borderRadius: '0.25rem',
                                                            background: 'oklch(0.65 0.15 200 / 0.2)',
                                                            fontSize: '0.75rem',
                                                            marginRight: '0.5rem'
                                                        }}>
                                                            {skill.type === 'normal' ? 'æ™®é€šæ”»æ“Š' : 'æŠ€èƒ½æ”»æ“Š'}
                                                        </span>
                                                        <span style={{ fontWeight: 'bold' }}>{skill.name}</span>
                                                    </div>
                                                    <span className="text-muted" style={{ fontSize: '0.875rem' }}>Lv.{skill.level}</span>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Formation Component
        function Formation() {
            const { setCurrentScene, saveData, updateFormation } = useGame();
            const [selectedPosition, setSelectedPosition] = useState(null);
            
            if (!saveData) return null;
            
            const formation = saveData.formation;
            const availableHeroes = saveData.heroes.filter(h => !formation.some(f => f?.id === h.id));
            
            const handleAddHero = (hero) => {
                if (selectedPosition === null) return;
                const newFormation = [...formation];
                newFormation[selectedPosition] = hero;
                updateFormation(newFormation);
                setSelectedPosition(null);
            };
            
            const handleRemoveHero = (position) => {
                const newFormation = [...formation];
                newFormation[position] = null;
                updateFormation(newFormation);
            };
            
            const deployedCount = formation.filter(h => h !== null).length;
            
            return (
                <div>
                    <div className="top-bar">
                        <div className="container flex items-center gap-4">
                            <button className="btn" onClick={() => setCurrentScene('town')}>â† è¿”å›</button>
                            <h1 style={{ fontSize: '1.5rem', fontWeight: 'bold' }} className="text-primary">ç·¨çµ„</h1>
                        </div>
                    </div>
                    
                    <div className="container">
                        <div className="grid grid-2 gap-6">
                            <div className="card">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>éšŠä¼1</h2>
                                    <div className="text-muted">ä¸Šé™£äººæ•¸: {deployedCount}/5</div>
                                </div>
                                
                                <div className="grid grid-2 gap-4 mb-4">
                                    {[3, 0, 4, 1, 5, 2].map((pos, idx) => {
                                        const hero = formation[pos];
                                        return (
                                            <div 
                                                key={pos}
                                                className={`position-slot ${hero ? 'filled' : ''} ${selectedPosition === pos ? 'selected' : ''}`}
                                                onClick={() => setSelectedPosition(pos)}
                                                style={selectedPosition === pos ? { borderColor: 'oklch(0.65 0.15 200)', background: 'oklch(0.65 0.15 200 / 0.1)' } : {}}
                                            >
                                                <div className="position-label">{pos + 1}</div>
                                                {hero ? (
                                                    <div className="text-center">
                                                        <div style={{ fontSize: '2.5rem' }}>{hero.portrait}</div>
                                                        <div style={{ fontSize: '0.875rem', fontWeight: 'bold' }}>{hero.name}</div>
                                                        <div className="text-muted" style={{ fontSize: '0.75rem' }}>Lv.{hero.level}</div>
                                                        <button 
                                                            onClick={(e) => { e.stopPropagation(); handleRemoveHero(pos); }}
                                                            style={{
                                                                position: 'absolute',
                                                                top: '0.5rem',
                                                                right: '0.5rem',
                                                                width: '1.5rem',
                                                                height: '1.5rem',
                                                                borderRadius: '50%',
                                                                background: 'oklch(0.6 0.2 20)',
                                                                border: 'none',
                                                                color: 'white',
                                                                cursor: 'pointer'
                                                            }}
                                                        >
                                                            Ã—
                                                        </button>
                                                    </div>
                                                ) : (
                                                    <div className="text-muted">ç©ºä½</div>
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                                
                                <div className="flex gap-2 text-muted mb-4" style={{ fontSize: '0.875rem' }}>
                                    <span>â† å¾Œæ’</span>
                                    <span style={{ flex: 1, textAlign: 'center' }}>ä¸­æ’</span>
                                    <span>å‰æ’ â†’</span>
                                </div>
                                
                                <div className="flex gap-2">
                                    <button className="btn" style={{ flex: 1 }}>ä¿å­˜</button>
                                    <button className="btn" style={{ flex: 1 }}>æ›´æ›</button>
                                    <button className="btn btn-primary" style={{ flex: 1 }} onClick={() => setCurrentScene('battle')}>æˆ°é¬¥</button>
                                </div>
                            </div>
                            
                            <div className="card">
                                <h2 style={{ fontSize: '1.25rem', fontWeight: 'bold' }} className="mb-4">è‹±é›„</h2>
                                {selectedPosition !== null ? (
                                    <div className="flex flex-col gap-2">
                                        <p className="text-muted mb-2" style={{ fontSize: '0.875rem' }}>
                                            é¸æ“‡è¦æ”¾ç½®åœ¨ä½ç½® {selectedPosition + 1} çš„è‹±é›„
                                        </p>
                                        {availableHeroes.map(hero => (
                                            <button 
                                                key={hero.id}
                                                className="btn w-full"
                                                style={{ padding: '1rem', textAlign: 'left' }}
                                                onClick={() => handleAddHero(hero)}
                                            >
                                                <span style={{ fontSize: '1.5rem', marginRight: '0.5rem' }}>{hero.portrait}</span>
                                                {hero.name} Â· Lv.{hero.level}
                                            </button>
                                        ))}
                                        {availableHeroes.length === 0 && (
                                            <div className="text-center text-muted" style={{ padding: '2rem' }}>
                                                æ²’æœ‰å¯ç”¨çš„è‹±é›„
                                            </div>
                                        )}
                                    </div>
                                ) : (
                                    <div className="text-center text-muted" style={{ padding: '3rem' }}>
                                        é»æ“Šå·¦å´ä½ç½®ä¾†é¸æ“‡è‹±é›„
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Map Component
        function MapExplore() {
            const { setCurrentScene, saveData } = useGame();
            
            if (!saveData) return null;
            
            return (
                <div>
                    <div className="top-bar">
                        <div className="container flex justify-between items-center">
                            <div className="flex items-center gap-4">
                                <button className="btn" onClick={() => setCurrentScene('town')}>â† è¿”å›</button>
                                <h1 style={{ fontSize: '1.5rem', fontWeight: 'bold' }} className="text-primary">åœ°åœ–æ¢ç´¢</h1>
                            </div>
                            <div className="text-muted">{saveData.location} Â· é€²åº¦: 0%</div>
                        </div>
                    </div>
                    
                    <div className="container">
                        <div className="card">
                            <div style={{ textAlign: 'center', padding: '4rem' }}>
                                <div style={{ fontSize: '4rem', marginBottom: '2rem' }}>ğŸ—ºï¸</div>
                                <h2 style={{ fontSize: '1.5rem', fontWeight: 'bold' }} className="mb-4">åœ°åœ–æ¢ç´¢</h2>
                                <p className="text-muted mb-8">é¸æ“‡ç¯€é»é–‹å§‹å†’éšª</p>
                                <button className="btn btn-primary" onClick={() => setCurrentScene('battle')}>
                                    é–‹å§‹æˆ°é¬¥
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Battle Component
        function Battle() {
            const { setCurrentScene, saveData } = useGame();
            const [gameSpeed, setGameSpeed] = useState(1.0);
            
            if (!saveData) return null;
            
            const heroes = saveData.formation.filter(h => h !== null);
            const speeds = [1.0, 1.5, 2.0, 2.5, 3.0];
            
            return (
                <div>
                    <div className="top-bar">
                        <div className="container flex justify-between items-center">
                            <div className="flex items-center gap-4">
                                <button className="btn" onClick={() => setCurrentScene('map')}>â¸ æš«åœ</button>
                                <div>{saveData.location}</div>
                            </div>
                            <div className="flex gap-2">
                                {speeds.map(speed => (
                                    <button 
                                        key={speed}
                                        className={gameSpeed === speed ? 'btn btn-primary' : 'btn'}
                                        onClick={() => setGameSpeed(speed)}
                                        style={{ minWidth: '4rem' }}
                                    >
                                        {speed}x
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                    
                    <div style={{ minHeight: '70vh', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '2rem' }}>
                        <div style={{ width: '100%', maxWidth: '1200px' }}>
                            <div style={{ textAlign: 'center', marginBottom: '4rem' }}>
                                <div style={{ fontSize: '4rem', marginBottom: '1rem' }}>ğŸ‘¹</div>
                                <div style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>å“¥å¸ƒæ—</div>
                                <div className="progress-bar" style={{ width: '6rem', margin: '0.5rem auto' }}>
                                    <div className="progress-fill" style={{ width: '80%', background: 'oklch(0.7 0.18 40)' }}></div>
                                </div>
                            </div>
                            
                            <div className="flex justify-center gap-8" style={{ flexWrap: 'wrap' }}>
                                {heroes.map(hero => (
                                    <div key={hero.id} className="text-center">
                                        <div style={{ fontSize: '3.5rem', marginBottom: '0.5rem' }}>{hero.portrait}</div>
                                        <div className="progress-bar" style={{ width: '6rem', margin: '0 auto 0.25rem' }}>
                                            <div className="progress-fill" style={{ width: `${(hero.hp / hero.maxHp) * 100}%` }}></div>
                                        </div>
                                        <div style={{ fontSize: '0.875rem', fontWeight: 'bold' }}>{hero.name}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                    
                    <div className="top-bar" style={{ borderTop: '2px solid oklch(0.3 0.02 220)', borderBottom: 'none' }}>
                        <div className="container flex gap-4" style={{ overflowX: 'auto' }}>
                            {heroes.map(hero => (
                                <div key={hero.id} className="stat-box" style={{ minWidth: '12rem' }}>
                                    <div className="flex items-center gap-2 mb-2">
                                        <span style={{ fontSize: '1.5rem' }}>{hero.portrait}</span>
                                        <div style={{ flex: 1 }}>
                                            <div style={{ fontSize: '0.875rem', fontWeight: 'bold' }}>{hero.name}</div>
                                            <div className="text-muted" style={{ fontSize: '0.75rem' }}>Lv.{hero.level}</div>
                                        </div>
                                    </div>
                                    <div className="progress-bar mb-1">
                                        <div className="progress-fill" style={{ width: `${(hero.hp / hero.maxHp) * 100}%` }}></div>
                                    </div>
                                    <div className="text-muted" style={{ fontSize: '0.75rem' }}>HP: {hero.hp}/{hero.maxHp}</div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }
        
        // Main App Component
        function App() {
            const { currentScene } = useGame();
            
            const scenes = {
                menu: <MainMenu />,
                setup: <GameSetup />,
                town: <Town />,
                heroes: <Heroes />,
                formation: <Formation />,
                map: <MapExplore />,
                battle: <Battle />
            };
            
            return scenes[currentScene] || <MainMenu />;
        }
        
        // Render App
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <GameProvider>
                <App />
            </GameProvider>
        );
    </script>
</body>
</html>
